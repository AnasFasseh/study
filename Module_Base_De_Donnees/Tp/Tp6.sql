create database DBEmployee;

use DBEmployee;

CREATE TABLE DEPT
( 
	DEPT   int PRIMARY KEY,
	NOMD   VARCHAR(12) NOT NULL UNIQUE,
	LIEU   VARCHAR(10)
);

CREATE TABLE EMP
(
	MATR   int PRIMARY KEY,
	NOME   VARCHAR(10) NOT NULL,
	POSTE  VARCHAR(10),
	SUP    int,
	DATEMB DATE,
	SAL    int,
	COMM   int,
    DEPT int,
	CONSTRAINT fk_DEPT_REF_EMP foreign key (DEPT) REFERENCES DEPT (DEPT)
);

INSERT INTO DEPT VALUES(10,'FINANCES','PARIS');
INSERT INTO DEPT VALUES(20,'RECHERCHES','GRENOBLE');
INSERT INTO DEPT VALUES(30,'VENTES','LYON');
INSERT INTO DEPT VALUES(40,'FABRICATION','ROUEN');

INSERT INTO EMP VALUES(7369,'LECLERC','SECRETAIRE',7902,'1980-12-02',6400.00,NULL,20);
INSERT INTO EMP VALUES(7499,'BIRAUD','COMMERCIAL',7698,'1981-2-20',12800.00,2400.00,30);
INSERT INTO EMP VALUES(7521,'BERGER','COMMERCIAL',7698,'1981-10-22',10000.00,4000.00,30);
INSERT INTO EMP VALUES(7566,'MERCIER','DIRECTEUR',7839,'1981-3-02',23000.00,NULL,20);
INSERT INTO EMP VALUES(7654,'MARTIN','COMMERCIAL',7698,'1981-5-28',10000.00,11200.00,30);
INSERT INTO EMP VALUES(7698,'NOIRET','DIRECTEUR',7839,'1981-5-01',22800.00,NULL,30);
INSERT INTO EMP VALUES(7782,'LESAGE','DIRECTEUR',7839,'1981-6-09',19600.00,NULL,10);
INSERT INTO EMP VALUES(7788,'DUBOIS','INGENIEUR',7566,'1985-4-14',24000.00,NULL,20);
INSERT INTO EMP VALUES(7839,'LEROY','PRESIDENT',NULL,'1981-11-17',40000.00,NULL,10);
INSERT INTO EMP VALUES(7844,'BENAIN','COMMERCIAL',7698,'1981-5-08',12000.00,0.00,30);
INSERT INTO EMP VALUES(7876,'CLEMENT','SECRETAIRE',7788,'1985-5-10',8800.00,NULL,20);
INSERT INTO EMP VALUES(7900,'FREMONT','SECRETAIRE',7698,'1981-12-03',7600.00,NULL,30);
INSERT INTO EMP VALUES(7902,'CHATEL','INGENIEUR',7566,'1981-12-17',24000.00,NULL,20);
INSERT INTO EMP VALUES(7934,'VILLARD','SECRETAIRE',7782,'1982-8-23',10400.00,NULL,10);

#Tp6
#Q1
select * from EMP where (post='COMMERCIAL') and (DEPT in (20,30));
#Q2
select * from EMP where ((post<>'COMMERCIAL') and (DATEMB between '1981-01-01' and '1981-12-31'));
#Q3
select * from EMP where NOME like '%M%' and NOME like '%A%' ;
#Q4
select * from EMP where NOME like '%A%A%';
#Q5
select * from EMP where COMM is Null;
#Q6
select NOME,DEPT,POSTE,DATEMB from EMP 
order by DEPT,POSTE,DATEMB desc;
#Q7
select NOME,SAL,COMM from EMP where COMM is not null
order by SAL,COMM;
#Q8
select NOME from EMP where NOME like '__A%';
#Q9
select NOME,POSTE,SAL from EMP where not (SAL=10000 or SAL=30000 or SAL=50000);
#Q10
select NOME,SAL,COMM from EMP where COMM > 1.1*SAL;
#Q11
select MATR,NOME,SAL,SAL*1.15 from EMP;

#Exercice d'application (fonction d'agregat)
#Q1
select max(SAL) from EMP where POSTE='COMMERCIAL';
#Q2
select avg(SAL) from EMP where DEPT=30;
#Q3
select max(COMM)-min(COMM) from EMP where POSTE='COMMERCIAL';
#Q4
select sum(SAL) from EMP where DEPT=20;
#Q5
select count(POSTE) from EMP where COMM is not null;
#Q6
select count(*) from EMP where year(DATEMB)='1981';
#Q7
select count(*) from EMP;
#Q8
select count(DEPT) from EMP where POSTE='INGENIEUR';
#Q9
select count(distinct POSTE) from EMP;
#Q10
select min(DATEMB) from EMP;
#Q11
select min(SAL) from EMP;